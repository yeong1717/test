<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modern Snake Game</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background-color: #0f172a;
            color: #f8fafc;
            touch-action: none; /* ìŠ¤ì™€ì´í”„ ì‹œ í™”ë©´ ìŠ¤í¬ë¡¤ ë°©ì§€ */
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, Roboto, sans-serif;
        }
        canvas {
            background-color: #1e293b;
            border-radius: 1rem;
            box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
            max-width: 95vw;
            max-height: 70vh;
        }
        .ui-container {
            width: 100%;
            max-width: 400px;
            padding: 1rem;
            text-align: center;
        }
        .btn-primary {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            transition: transform 0.1s ease-in-out;
        }
        .btn-primary:active {
            transform: scale(0.95);
        }
    </style>
</head>
<body>

    <div class="ui-container mb-4">
        <h1 class="text-3xl font-bold mb-2">ìŠ¤ë„¤ì´í¬ ê²Œì„</h1>
        <div class="flex justify-between items-center bg-slate-800 p-4 rounded-xl mb-4">
            <div>
                <p class="text-xs text-slate-400 uppercase font-semibold">Score</p>
                <p id="score" class="text-2xl font-mono">0</p>
            </div>
            <div>
                <p class="text-xs text-slate-400 uppercase font-semibold">Best</p>
                <p id="highScore" class="text-2xl font-mono">0</p>
            </div>
        </div>
    </div>

    <canvas id="gameCanvas"></canvas>

    <div id="startScreen" class="absolute inset-0 bg-slate-900/80 backdrop-blur-sm flex flex-col items-center justify-center z-10">
        <div class="bg-slate-800 p-8 rounded-2xl shadow-2xl text-center border border-slate-700">
            <h2 class="text-4xl mb-4">ğŸ</h2>
            <p class="text-xl mb-6 font-medium">ì¤€ë¹„ë˜ì…¨ë‚˜ìš”?</p>
            <button id="startBtn" class="btn-primary px-8 py-3 rounded-full font-bold text-lg shadow-lg">ê²Œì„ ì‹œì‘</button>
            <p class="mt-4 text-slate-400 text-sm">PC: í™”ì‚´í‘œ í‚¤ | Mobile: ìŠ¤ì™€ì´í”„</p>
        </div>
    </div>

    <div id="gameOverScreen" class="hidden absolute inset-0 bg-red-900/80 backdrop-blur-sm flex flex-col items-center justify-center z-10">
        <div class="bg-slate-800 p-8 rounded-2xl shadow-2xl text-center border border-slate-700">
            <h2 class="text-2xl font-bold text-red-400 mb-2">GAME OVER</h2>
            <p id="finalScore" class="text-4xl font-mono mb-6">0</p>
            <button id="restartBtn" class="btn-primary px-8 py-3 rounded-full font-bold text-lg shadow-lg">ë‹¤ì‹œ ë„ì „</button>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreEl = document.getElementById('score');
        const highScoreEl = document.getElementById('highScore');
        const finalScoreEl = document.getElementById('finalScore');
        const startScreen = document.getElementById('startScreen');
        const gameOverScreen = document.getElementById('gameOverScreen');
        const startBtn = document.getElementById('startBtn');
        const restartBtn = document.getElementById('restartBtn');

        // ê²Œì„ ì„¤ì •
        let gridSize = 20;
        let tileCount = 20;
        let snake = [{x: 10, y: 10}];
        let food = {x: 15, y: 15};
        let dx = 0;
        let dy = 0;
        let score = 0;
        let highScore = localStorage.getItem('snakeHighScore') || 0;
        let gameLoop;
        let isPaused = true;
        let speed = 100;

        highScoreEl.innerText = highScore;

        // ë°˜ì‘í˜• ìº”ë²„ìŠ¤ ì„¤ì •
        function resizeCanvas() {
            const size = Math.min(window.innerWidth * 0.95, 400);
            canvas.width = size;
            canvas.height = size;
            gridSize = canvas.width / tileCount;
        }

        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();

        // ì…ë ¥ ì²˜ë¦¬ (í‚¤ë³´ë“œ)
        document.addEventListener('keydown', (e) => {
            switch(e.key) {
                case 'ArrowUp': if (dy !== 1) { dx = 0; dy = -1; } break;
                case 'ArrowDown': if (dy !== -1) { dx = 0; dy = 1; } break;
                case 'ArrowLeft': if (dx !== 1) { dx = -1; dy = 0; } break;
                case 'ArrowRight': if (dx !== -1) { dx = 1; dy = 0; } break;
            }
        });

        // ì…ë ¥ ì²˜ë¦¬ (ìŠ¤ì™€ì´í”„)
        let touchStartX = 0;
        let touchStartY = 0;

        document.addEventListener('touchstart', (e) => {
            touchStartX = e.touches[0].clientX;
            touchStartY = e.touches[0].clientY;
        }, false);

        document.addEventListener('touchend', (e) => {
            if (isPaused) return;
            
            let touchEndX = e.changedTouches[0].clientX;
            let touchEndY = e.changedTouches[0].clientY;
            
            let diffX = touchEndX - touchStartX;
            let diffY = touchEndY - touchStartY;
            
            if (Math.abs(diffX) > Math.abs(diffY)) {
                if (diffX > 0 && dx !== -1) { dx = 1; dy = 0; } // Right
                else if (diffX < 0 && dx !== 1) { dx = -1; dy = 0; } // Left
            } else {
                if (diffY > 0 && dy !== -1) { dx = 0; dy = 1; } // Down
                else if (diffY < 0 && dy !== 1) { dx = 0; dy = -1; } // Up
            }
        }, false);

        function startGame() {
            snake = [{x: 10, y: 10}];
            dx = 1; dy = 0;
            score = 0;
            scoreEl.innerText = score;
            isPaused = false;
            startScreen.classList.add('hidden');
            gameOverScreen.classList.add('hidden');
            createFood();
            
            if (gameLoop) clearInterval(gameLoop);
            gameLoop = setInterval(draw, speed);
        }

        function createFood() {
            food = {
                x: Math.floor(Math.random() * tileCount),
                y: Math.floor(Math.random() * tileCount)
            };
            // ë±€ ìœ„ì— ìŒì‹ì´ ìƒì„±ë˜ì§€ ì•Šë„ë¡ í™•ì¸
            for (let part of snake) {
                if (part.x === food.x && part.y === food.y) {
                    createFood();
                    break;
                }
            }
        }

        function draw() {
            // ìœ„ì¹˜ ì—…ë°ì´íŠ¸
            const head = {x: snake[0].x + dx, y: snake[0].y + dy};

            // ì¶©ëŒ ê°ì§€ (ë²½)
            if (head.x < 0 || head.x >= tileCount || head.y < 0 || head.y >= tileCount) {
                return gameOver();
            }

            // ì¶©ëŒ ê°ì§€ (ìì‹ )
            for (let i = 0; i < snake.length; i++) {
                if (head.x === snake[i].x && head.y === snake[i].y) {
                    return gameOver();
                }
            }

            snake.unshift(head);

            // ìŒì‹ ì„­ì·¨
            if (head.x === food.x && head.y === food.y) {
                score += 10;
                scoreEl.innerText = score;
                if (score > highScore) {
                    highScore = score;
                    highScoreEl.innerText = highScore;
                    localStorage.setItem('snakeHighScore', highScore);
                }
                createFood();
            } else {
                snake.pop();
            }

            // ê·¸ë¦¬ê¸°
            ctx.fillStyle = '#1e293b';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // ìŒì‹ ê·¸ë¦¬ê¸°
            ctx.fillStyle = '#ef4444';
            ctx.beginPath();
            ctx.arc((food.x + 0.5) * gridSize, (food.y + 0.5) * gridSize, gridSize/2.5, 0, Math.PI * 2);
            ctx.fill();

            // ë±€ ê·¸ë¦¬ê¸°
            snake.forEach((part, index) => {
                ctx.fillStyle = index === 0 ? '#60a5fa' : '#3b82f6';
                const padding = 1;
                ctx.beginPath();
                ctx.roundRect(
                    part.x * gridSize + padding, 
                    part.y * gridSize + padding, 
                    gridSize - padding * 2, 
                    gridSize - padding * 2,
                    4
                );
                ctx.fill();
            });
        }

        function gameOver() {
            isPaused = true;
            clearInterval(gameLoop);
            finalScoreEl.innerText = score;
            gameOverScreen.classList.remove('hidden');
        }

        startBtn.addEventListener('click', startGame);
        restartBtn.addEventListener('click', startGame);

        // ì´ˆê¸° í™”ë©´ ê·¸ë¦¬ê¸°
        window.onload = () => {
            ctx.fillStyle = '#1e293b';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
        };
    </script>
</body>
</html>
